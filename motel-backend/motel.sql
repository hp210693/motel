-- To the change password
-- sudo -u postgres psql
-- \password postgres

SELECT *
FROM pg_stat_activity
WHERE datname = 'motel';

SELECT
	pg_terminate_backend (pg_stat_activity.pid)
FROM
	pg_stat_activity
WHERE
	pg_stat_activity.datname = 'motel';

drop database motel;

create database motel;

-- create table---------------------------------------------------------------------------------------------------
drop table flow;
drop TABLE room;
drop TABLE account;
drop TABLE role;
drop TABLE bill;

CREATE TABLE flow(
	flow_id INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
	flow_name VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE role(
	role_id INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
	role_name VARCHAR(50) NOT NULL UNIQUE,
	grant_date TIMESTAMP DEFAULT(CURRENT_TIMESTAMP(0))
);

CREATE TABLE room(
	room_id INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
	flow_id INT NULL REFERENCES flow(flow_id),
	area VARCHAR(50) DEFAULT('') NULL,
	status_room INT DEFAULT(-1) NOT NULL,
	room_name VARCHAR(255) NOT NULL UNIQUE,
	booking_date TIMESTAMP DEFAULT(CURRENT_TIMESTAMP(0)) NULL,
	date_move_in TIMESTAMP DEFAULT(CURRENT_TIMESTAMP(0)) NULL,
	date_move_out TIMESTAMP DEFAULT(CURRENT_TIMESTAMP(0)) NULL,
	total_days FLOAT DEFAULT(0),
	electric_number FLOAT DEFAULT(0),
	electric_price FLOAT DEFAULT(0),
	deposits FLOAT DEFAULT(0),
	img_electric TEXT DEFAULT(''),
	img_room_rates TEXT DEFAULT(''),
	img_water TEXT DEFAULT(''),
	junk_money FLOAT DEFAULT(0),
	num_of_member INT DEFAULT(0),
	room_rates FLOAT DEFAULT(0),
	water_number FLOAT DEFAULT(0),
	water_price FLOAT DEFAULT(0)
);

CREATE TABLE account(
	account_id INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
	room_id INT NULL REFERENCES room (room_id),
	user_name VARCHAR(512) UNIQUE NOT NULL,
	password VARCHAR(1024) NOT NULL,
	email VARCHAR(255) UNIQUE NOT NULL,
	created_on TIMESTAMP DEFAULT(CURRENT_TIMESTAMP(0)) NOT NULL,
    last_login TIMESTAMP DEFAULT(CURRENT_TIMESTAMP(0)) NOT NULL
);

CREATE TABLE bill(
	bill_id INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
	account_id INT NULL REFERENCES account (account_id),
	room_id INT NOT NULL REFERENCES room (room_id),
	created_date TIMESTAMP DEFAULT(CURRENT_TIMESTAMP(0)) NOT NULL,
    total_payment FLOAT DEFAULT(0) NOT NULL,
	img_total_payment TEXT DEFAULT('') NULL,
	note TEXT DEFAULT('') NULL
);

--ALTER TABLE payment
--add note TEXT NULL;


-- SELECT TABLE ------------------------------------------------------------------------------------------------------------
SELECT * FROM room;
SELECT * FROM flow;
SELECT * FROM role;
SELECT * FROM account;
SELECT * FROM bill;


-- INSERT TABLE----------------------------------------------------------------------------------------------------------
INSERT INTO flow (flow_name) VALUES
	('flow-A'),
	('flow-B'),
	('flow-C'),
	('flow-D'),
	('flow-E'),
	('flow-F'),
	('flow-G'),
	('flow-H'),
	('flow-K'),
	('flow-KIOT');

INSERT INTO role(role_name, grant_date) VALUES
	('admin',CURRENT_TIMESTAMP(0)),
	('host',CURRENT_TIMESTAMP(0)),
	('manager',CURRENT_TIMESTAMP(0)),
	('client',CURRENT_TIMESTAMP(0)),
	('user',CURRENT_TIMESTAMP(0));

INSERT INTO room(
	flow_id,status_room, room_name, booking_date,date_move_in,
	date_move_out,total_days,electric_number,electric_price,
	deposits,img_electric,img_room_rates,img_water,junk_money,
	num_of_member,room_rates,water_number,water_price) VALUES
	-- A --
	(1,0,'A1',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,900000,0,10000),
	(1,0,'A2',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(1,0,'A3',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(1,0,'A4',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(1,0,'A5',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(1,0,'A6',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(1,0,'A7',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(1,0,'A8',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(1,0,'A9',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(1,0,'A10',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	-- B --
	(2,0,'B1',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(2,0,'B2',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(2,0,'B3',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(2,0,'B4',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(2,0,'B5',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(2,0,'B6',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(2,0,'B7',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(2,0,'B8',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(2,0,'B9',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(2,0,'B10',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,900000,0,10000),
	-- C --
	(3,0,'C1',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(3,0,'C2',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(3,0,'C3',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(3,0,'C4',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(3,0,'C5',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(3,0,'C6',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(3,0,'C7',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(3,0,'C8',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(3,0,'C9',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(3,0,'C10',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	-- D --
	(4,0,'D0',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,900000,0,10000),
	(4,0,'D1',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(4,0,'D2',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(4,0,'D3',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(4,0,'D4',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(4,0,'D5',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(4,0,'D6',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(4,0,'D7',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(4,0,'D8',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(4,0,'D9',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(4,0,'D10',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	-- E --
	(5,0,'E0',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(5,0,'E1',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(5,0,'E2',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(5,0,'E3',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(5,0,'E4',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(5,0,'E5',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(5,0,'E6',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(5,0,'E7',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(5,0,'E8',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(5,0,'E9',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(5,0,'E10',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,900000,0,10000),
	-- F --
	(6,0,'F1',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,1000000,0,10000),
	(6,0,'F2',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(6,0,'F3',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(6,0,'F4',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(6,0,'F5',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(6,0,'F6',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(6,0,'F7',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(6,0,'F8',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(6,0,'F9',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(6,0,'F10',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,1000000,0,10000),
	-- G --
	(7,0,'G1',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(7,0,'G2',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(7,0,'G3',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(7,0,'G4',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(7,0,'G5',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(7,0,'G6',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(7,0,'G7',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(7,0,'G8',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(7,0,'G9',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(7,0,'G10',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(7,0,'G11',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,1200000,0,10000),
	-- H --
	(8,0,'H0',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,900000,0,10000),
	(8,0,'H1',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(8,0,'H2',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(8,0,'H3',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(8,0,'H4',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(8,0,'H5',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(8,0,'H6',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(8,0,'H7',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(8,0,'H8',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(8,0,'H9',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(8,0,'H10',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(8,0,'H11',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,1200000,0,10000),
	-- K --
	(9,0,'K0',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,900000,0,10000),
	(9,0,'K1',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(9,0,'K2',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(9,0,'K3',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(9,0,'K4',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(9,0,'K5',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(9,0,'K6',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(9,0,'K7',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(9,0,'K8',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(9,0,'K9',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(9,0,'K10',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	(9,0,'K11',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,800000,0,10000),
	-- KIOT --
	(10,0,'KIOT1',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,3000000,0,10000),
	(10,0,'KIOT2',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,1400000,0,10000),
	(10,0,'KIOT3',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,1600000,0,10000),
	(10,0,'KIOT4',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,2000000,0,10000),
	(10,0,'KIOT5',NULL,NULL,NULL,0,0,3000,0,'','','',15000,0,2000000,0,10000);



INSERT INTO account(
	room_id, user_name,password,email,created_on,last_login) VALUES
	(NULL,'admin','admin','admin@gmail.com',CURRENT_TIMESTAMP(0),CURRENT_TIMESTAMP(0)),
	(1,'A1-034982142','123456789','abc1@gmail.com',CURRENT_TIMESTAMP(0),CURRENT_TIMESTAMP(0)),
	(1,'A10-034982142','123456789','abc12@gmail.com',CURRENT_TIMESTAMP(0),CURRENT_TIMESTAMP(0)),
	(2,'B1-034982142','123456789','abc2@gmail.com',CURRENT_TIMESTAMP(0),CURRENT_TIMESTAMP(0)),
	(3,'C1-034982142','123456789','abc3@gmail.com',CURRENT_TIMESTAMP(0),CURRENT_TIMESTAMP(0)),
	(4,'D1-034982142','123456789','abc4@gmail.com',CURRENT_TIMESTAMP(0),CURRENT_TIMESTAMP(0)),
	(5,'E1-034982142','123456789','abc5@gmail.com',CURRENT_TIMESTAMP(0),CURRENT_TIMESTAMP(0)),
	(6,'F1-034982142','123456789','abc6@gmail.com',CURRENT_TIMESTAMP(0),CURRENT_TIMESTAMP(0)),
	(7,'G1-034982142','123456789','abc7@gmail.com',CURRENT_TIMESTAMP(0),CURRENT_TIMESTAMP(0)),
	(8,'H1-034982142','123456789','abc8@gmail.com',CURRENT_TIMESTAMP(0),CURRENT_TIMESTAMP(0)),
	(9,'K1-034982142','123456789','abc10@gmail.com',CURRENT_TIMESTAMP(0),CURRENT_TIMESTAMP(0)),
	(10,'KIOT1-034982142','123456789','abc13@gmail.com',CURRENT_TIMESTAMP(0),CURRENT_TIMESTAMP(0)),
	(10,'KIOT2-034982142','123456789','abc11@gmail.com',CURRENT_TIMESTAMP(0),CURRENT_TIMESTAMP(0));

INSERT INTO bill(account_id, room_id) VALUES
					(1,1),
					(3,1),
					(4,1),
					(5,2);
					 
SELECT *From account;
SELECT *From bill;
SELECT *From room; 
